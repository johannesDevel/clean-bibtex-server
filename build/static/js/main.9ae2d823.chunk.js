(window["webpackJsonpclean-bibtex"]=window["webpackJsonpclean-bibtex"]||[]).push([[0],{14:function(e,t,n){},15:function(e,t,n){},16:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n.n(i),r=n(8),s=n.n(r),c=(n(14),n(6)),l=n(1),o=n(2),u=n(4),h=n(3),d=n(5),p=(n(15),function(e){return new Promise(function(t){var n=new FileReader;n.onload=function(e){t(e.target.result)},n.readAsText(e)})});var g=function(e){return a.a.createElement("div",{className:"start-upload-button"},a.a.createElement("label",{htmlFor:"file"},a.a.createElement("br",null),a.a.createElement("br",null),a.a.createElement("br",null),"Upload BibteX"),a.a.createElement("input",{id:"file",className:"input-file",type:"file",onChange:function(t){var n=t.target.files[0];n&&p(n).then(function(t){t.length>3&&e.setBibtex(t)})}}))},m=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(u.a)(this,Object(h.a)(t).call(this,e))).onChangeText=function(e){n.setState({textInput:e},function(){return n.checkIfBibtex()})},n.checkIfBibtex=function(){n.state.textInput.length>30&&n.state.textInput.includes("@")?(console.log("is probably bibtex, will send to server"),n.props.setBibtex(n.state.textInput)):console.log("is not a bibtex, not sending to server")},n.state={isBibtex:!1,textInput:""},n}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this;return a.a.createElement("div",{className:"start-wrapper"},a.a.createElement("div",{className:"start"},a.a.createElement("div",{className:"start-inputs"},a.a.createElement("textarea",{className:"start-input-field",type:"text",placeholder:"Paste your BibTeX file here",value:this.state.bibtexText,onChange:function(t){return e.onChangeText(t.target.value)}}),a.a.createElement(g,{setBibtex:this.props.setBibtex}))))}}]),t}(i.Component);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(n,!0).forEach(function(t){Object(c.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var O=localStorage.token;O||(O=localStorage.token=123);var E={Accept:"application/json",Authorization:O},v=function(){return fetch("/bibtex",{headers:E}).then(function(e){return e.json()})},S=function(e){return fetch("/update",{method:"POST",headers:b({},E,{"Content-Type":"application/json"}),body:JSON.stringify(e)}).then(function(e){return e})},C=function(e){return fetch("/bibtex",{method:"POST",headers:b({},E,{"Content-Type":"application/json"}),body:JSON.stringify(e)}).then(function(e){return e.json()})},y=function(e,t){return fetch("".concat("https://api.crossref.org","/works?query.bibliographic=").concat(e,"&query.author=").concat(t,"&rows=1")).then(function(e){return e.json()})},A=function(e){return fetch("".concat("https://api.crossref.org","/works?query.bibliographic=").concat(e,"&rows=1")).then(function(e){return e.json()})},k=function(e){function t(){var e,n;Object(l.a)(this,t);for(var i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(n=Object(u.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(a)))).onClick=function(){var e=n.props,t=e.label;(0,e.onClick)(t)},n}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.onClick,t=this.props,n=t.activeTab,i=t.label,r=t.status,s="tab-list-item";return n===i&&(s+=" tab-list-active"),a.a.createElement("li",{className:s,onClick:e},"".concat(i," - ").concat(r?"ok":"inconsistencies found"))}}]),t}(i.Component),N=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(u.a)(this,Object(h.a)(t).call(this,e))).onClickTab=function(e){return n.setState({activeTab:e})},n.state={activeTab:n.props.children[0].props.label},n}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.onClickTab,t=this.props.children,n=this.state.activeTab;return a.a.createElement("div",{className:"tabs"},a.a.createElement("ol",{className:"tab-list"},t.map(function(t){var i=t.props,r=i.label,s=i.status;return a.a.createElement(k,{activeTab:n,key:r,label:r,onClick:e,status:s})})),a.a.createElement("div",{className:"tab-content"},t.map(function(e){if(e.props.label===n)return e.props.children})))}}]),t}(i.Component),F=function(e){function t(){var e,n;Object(l.a)(this,t);for(var i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(n=Object(u.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(a)))).state={showAdvancedSettings:!1,correctedElements:[],allSelected:!1},n.handleButton=function(){n.setState(function(e){return{showAdvancedSettings:!e.showAdvancedSettings}})},n.handleSaveSelection=function(){console.log(n.props.options)},n.selectAll=function(){var e=!n.state.allSelected;n.setState({allSelected:e}),n.props.changeAllOptions(e)},n.handleChangeOption=function(e){var t=n.props.optionsCheckboxes.find(function(t){return t.id===e});t.checked=!t.checked,n.props.changeOption(t)},n.changeSelected=function(e){(n.props.optionsCheckboxes.some(function(e){return e.checked})||n.state.allSelected)&&(n.props.changeSelectedCapitalization(e),n.setState({allSelected:!1}))},n.getCaseSum=function(){var e={titleCaseSum:0,sentenceCaseSum:0,noCaseSum:0};return n.props.entries.forEach(function(t){"titleCase"===t.capitalization?e.titleCaseSum++:"sentenceCase"===t.capitalization?e.sentenceCaseSum++:e.noCaseSum++}),e},n}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.entries,i=t.optionsCheckboxes;return a.a.createElement("div",null,a.a.createElement("div",{className:"statistic"},a.a.createElement("h3",null,"Summary"),a.a.createElement("ul",null,a.a.createElement("li",null,n.length," Entries found"),this.getCaseSum().titleCaseSum>0&&a.a.createElement("li",null,this.getCaseSum().titleCaseSum," Title case entries found"),this.getCaseSum().sentenceCaseSum>0&&a.a.createElement("li",null,this.getCaseSum().sentenceCaseSum," Sentence case entries found"),this.getCaseSum().noCaseSum>0&&a.a.createElement("li",null,this.getCaseSum().noCaseSum," without known case found")),a.a.createElement("button",{className:"btn-toggle-advanced",onClick:function(t){return e.handleButton(t)}},"Correct errors")),this.state.showAdvancedSettings&&n.length>0&&a.a.createElement("div",{className:"corrections-table"},a.a.createElement("button",{className:"btn-select-all",disabled:!i.some(function(e){return e.checked}),onClick:function(){return e.changeSelected("titleCase")}},"Set selected to title case"),a.a.createElement("button",{className:"btn-select-all",disabled:!i.some(function(e){return e.checked}),onClick:function(){return e.changeSelected("sentenceCase")}},"Set selected to sentence case"),a.a.createElement("button",{className:"btn-select-all",disabled:!i.some(function(e){return e.checked}),onClick:function(){return e.changeSelected("initialCase")}},"Set selected to initial case"),a.a.createElement("table",null,a.a.createElement("tbody",null,a.a.createElement("tr",null,a.a.createElement("th",null,a.a.createElement("input",{type:"checkBox",name:"select-all-checkbox",checked:this.state.allSelected,onChange:function(){return e.selectAll()}})),a.a.createElement("th",null,"Current"),a.a.createElement("th",null,"Title case"),a.a.createElement("th",null,"Sentence case"))),n.map(function(t){return a.a.createElement("tbody",{key:t.id},a.a.createElement("tr",null,a.a.createElement("td",{className:"titleCase"===t.capitalization?"table-entry-green":"sentenceCase"===t.capitalization?"table-entry-blue":"table-entry-red"},a.a.createElement("input",{id:t.id,type:"checkBox",checked:i.find(function(e){return e.id===t.id}).checked,onChange:function(){return e.handleChangeOption(t.id)}})),a.a.createElement("td",{className:"titleCase"===t.capitalization?"table-entry-green":"sentenceCase"===t.capitalization?"table-entry-blue":"table-entry-red"},t.TITLE),a.a.createElement("td",{className:"table-entry-green"},t.correctionTitleCase),a.a.createElement("td",{className:"table-entry-blue"},t.correctionSentenceCase)))}))))}}]),t}(i.Component),j=function(e){function t(){var e,n;Object(l.a)(this,t);for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return(n=Object(u.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).state={allSelected:!1},n.getMissingFieldsEntries=function(){return n.props.entries.filter(function(e){return e.missingRequiredFields.length>0}).length},n.getCorrectedAttributeEntry=function(e){return n.props.entries.filter(function(t){return t.id===e.entryId}).find(function(t){return t[e.field.toUpperCase()]})},n.getCorrectedAttributeField=function(e){var t=n.getCorrectedAttributeEntry(e);if(null!=t){var i=t[e.field.toUpperCase()];return"author"===e.field&&i.length>0?i.map(function(e){return a.a.createElement("div",{key:e},e)}):i}return"-"},n.selectAll=function(){var e=!n.state.allSelected;n.setState(function(t){return{allSelected:e}}),n.props.selectAllMissingFieldsOptions(e)},n.getTableClassName=function(e){return null!=n.getCorrectedAttributeEntry(e)?"table-entry-green":e.suggestion.length>0?"table-entry-blue":"table-entry-red"},n}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this;return a.a.createElement("div",null,a.a.createElement("div",{className:"statistic"},a.a.createElement("h3",null,"Summary"),a.a.createElement("ul",null,a.a.createElement("li",null,this.props.entries.length," entries found"),a.a.createElement("li",null,this.getMissingFieldsEntries()," entries with missing required fields found"))),this.getMissingFieldsEntries()>0&&a.a.createElement("div",{className:"corrections-table"},a.a.createElement("button",{onClick:function(){return e.props.changeFieldSuggestion()},disabled:!this.props.missingFieldsOptions.some(function(e){return e.checked})},"Search suggestion online"),a.a.createElement("button",{disabled:!this.props.missingFieldsOptions.some(function(e){return e.checked}),onClick:function(){e.setState({allSelected:!1}),e.props.addMissingField()}},"Add suggestion to field"),a.a.createElement("table",null,a.a.createElement("tbody",null,a.a.createElement("tr",null,a.a.createElement("th",null,a.a.createElement("input",{type:"checkBox",name:"select-all-missing-fields-checkbox",checked:this.state.allSelected,onChange:function(){return e.selectAll()}})),a.a.createElement("th",null,"Missing field name"),a.a.createElement("th",null,"Added field"),a.a.createElement("th",null,"Suggestion"),a.a.createElement("th",null,"Title"))),this.props.missingFieldsOptions.map(function(t){return a.a.createElement("tbody",{key:"".concat(t.entryId,"+").concat(t.field)},a.a.createElement("tr",null,a.a.createElement("td",{className:e.getTableClassName(t)},a.a.createElement("input",{type:"checkbox",checked:t.checked,onChange:function(){return e.props.changeMissingFieldsOption(t)}})),a.a.createElement("td",{className:e.getTableClassName(t)},a.a.createElement("span",null,t.field)),a.a.createElement("td",{className:e.getTableClassName(t)},e.getCorrectedAttributeField(t)),a.a.createElement("td",{className:e.getTableClassName(t)},t.suggestion.length>0?t.suggestion.map(function(e){return a.a.createElement("div",{key:e},e)}):"-"),a.a.createElement("td",{className:e.getTableClassName(t)},e.props.entries.find(function(e){return e.id===t.entryId}).TITLE)))}))))}}]),t}(i.Component),T=function(e){function t(){var e,n;Object(l.a)(this,t);for(var i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(n=Object(u.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(a)))).state={allSelected:!1},n.getInconsistentAuthorEntries=function(){return n.props.entries.filter(function(e){return null!=e.AUTHOR&&e.AUTHOR.some(function(e){return e.abbreviated||e.misspelling||e.changedAbbreviation||e.changedMisspelling})})},n.getInconsistentAuthorEntriesCount=function(){return n.props.entries.filter(function(e){return null!=e.AUTHOR&&e.AUTHOR.some(function(e){return e.abbreviated||e.misspelling})})},n.searchSuggestions=function(){n.props.changeAuthorSuggestion(n.props.authorNameOptions.filter(function(e){return e.checked}))},n.selectAll=function(){var e=!n.state.allSelected;n.setState({allSelected:e}),n.props.changeAllAuthorNameOptions(e)},n.checkCorrectedAuthors=function(e){return n.props.entries.some(function(t){return t.id===e.entryId&&t.AUTHOR.some(function(t){return e.author===t.name&&!t.abbreviated&&!t.misspelling})})},n}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this;return a.a.createElement("div",null,a.a.createElement("div",{className:"statistic"},a.a.createElement("h3",null,"Summary"),a.a.createElement("ul",null,a.a.createElement("li",null,this.props.entries.length," entries found"),a.a.createElement("li",null,this.getInconsistentAuthorEntriesCount().length," entries with inconsistent author names found"))),this.getInconsistentAuthorEntries().length>0&&a.a.createElement("div",{className:"corrections-table"},a.a.createElement("button",{onClick:function(){return e.setState({allSelected:!1},e.searchSuggestions())},disabled:!this.props.authorNameOptions.some(function(e){return e.checked})},"Search author suggestion"),a.a.createElement("button",{onClick:function(){return e.setState({allSelected:!1},e.props.changeAuthorName())},disabled:!this.props.authorNameOptions.some(function(e){return e.checked})},"change author name to suggestion"),a.a.createElement("table",null,a.a.createElement("tbody",null,a.a.createElement("tr",null,a.a.createElement("th",null,a.a.createElement("input",{type:"checkBox",name:"select-all-author-name-checkbox",checked:this.state.allSelected,onChange:function(){return e.selectAll()}})),a.a.createElement("th",null,"Current Author Name"),a.a.createElement("th",null,"Author Name Suggestion"),a.a.createElement("th",null,"Entry Title"))),this.props.authorNameOptions.map(function(t){return a.a.createElement("tbody",{key:"".concat(t.entryId,"+").concat(t.author)},a.a.createElement("tr",null,a.a.createElement("td",{className:e.checkCorrectedAuthors(t)?"table-entry-green":"table-entry-red"},a.a.createElement("input",{type:"checkBox",checked:t.checked,onChange:function(){return e.props.changeAuthorNameOption(t)}})),a.a.createElement("td",{className:e.checkCorrectedAuthors(t)?"table-entry-green":"table-entry-red"},t.author),a.a.createElement("td",{className:e.checkCorrectedAuthors(t)?"table-entry-green":t.suggestion.length>0?"table-entry-blue":"table-entry-red"},null!=t.suggestion&&t.suggestion.length>0?t.suggestion[0]:"no suggestion found"),a.a.createElement("td",{className:"table-entry-grey"},t.title)))}))))}}]),t}(i.Component),x=function(e){function t(){var e,n;Object(l.a)(this,t);for(var i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(n=Object(u.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(a)))).downloadBibtex=function(e){if(console.log(e),null!=e&&null!=e.bibtex){var t=document.createElement("a"),n=new Blob([e.bibtex],{type:"text/plain"});t.href=URL.createObjectURL(n),t.download="changedBibTeX.bib",document.body.appendChild(t),t.click()}},n}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this;return a.a.createElement("div",{className:"start-wrapper"},a.a.createElement("div",{className:"start"},a.a.createElement("div",null,a.a.createElement(N,null,a.a.createElement("div",{label:"Capitalization",status:!this.props.entries.some(function(e){return"caseNotFound"===e.capitalization})},a.a.createElement(F,{entries:this.props.entries,optionsCheckboxes:this.props.capitalizationOptions,changeOption:this.props.changeOption,changeAllOptions:this.props.changeAllOptions,changeSelectedCapitalization:this.props.changeSelectedCapitalization})),a.a.createElement("div",{label:"Author name",status:0===this.props.entries.filter(function(e){return null!=e.AUTHOR&&e.AUTHOR.some(function(e){return e.abbreviated||e.misspelling})}).length},a.a.createElement(T,{entries:this.props.entries,getEntriesFromServer:this.props.getEntriesFromServer,changeAuthorName:this.props.changeAuthorName,changeAuthorSuggestion:this.props.changeAuthorSuggestion,authorNameOptions:this.props.authorNameOptions,changeAuthorNameOption:this.props.changeAuthorNameOption,changeAllAuthorNameOptions:this.props.changeAllAuthorNameOptions})),a.a.createElement("div",{label:"Mandatory fields",status:!this.props.entries.some(function(e){return e.missingRequiredFields.length>0})},a.a.createElement(j,{entries:this.props.entries,missingFieldsOptions:this.props.missingFieldsOptions,changeMissingFieldsOption:this.props.changeMissingFieldsOption,changeFieldSuggestion:this.props.changeFieldSuggestion,addMissingField:this.props.addMissingField,selectAllMissingFieldsOptions:this.props.selectAllMissingFieldsOptions})))),a.a.createElement("button",{className:"download-button",onClick:function(){return fetch("/changedBibtex",{headers:E}).then(function(e){return e.json()}).then(function(t){return e.downloadBibtex(t)})}},"Download BibTeX")))}}]),t}(i.Component),I=function(e){function t(){var e,n;Object(l.a)(this,t);for(var i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(n=Object(u.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(a)))).state={bibtexText:"",entries:[],capitalizationOptions:[],authorNameOptions:[],missingFieldsOptions:[]},n.setInitialAuthorNameOptions=function(e){return e.filter(function(e){return null!=e.AUTHOR&&e.AUTHOR.some(function(e){return e.abbreviated||e.misspelling||e.changedAbbreviation||e.changedMisspelling})}).flatMap(function(e){return e.AUTHOR.filter(function(e){return e.abbreviated||e.misspelling||e.changedAbbreviation||e.changedMisspelling}).map(function(t){return{entryId:e.id,title:e.TITLE,author:t.name,suggestion:t.suggestion,checked:!1}})}).sort(function(e,t){return e.author<t.author?-1:e.author>t.author?1:0})},n.setInitialMissingFieldsOptions=function(e){return e.filter(function(e){return e.missingRequiredFields.length>0||e.correctedRequiredFields.length>0}).flatMap(function(e){return e.missingRequiredFields.concat(e.correctedRequiredFields).map(function(t){return{entryId:e.id,title:e.TITLE,field:t,suggestion:[],checked:!1}})})},n.getEntriesFromServer=function(){v().then(function(e){n.loadDataFromServer(e)})},n.getSelectedEntries=function(){return n.state.entries.filter(function(e){return n.state.capitalizationOptions.find(function(t){return t.id===e.id&&t.checked})})},n.changeSelectedCapitalization=function(e){n.setState(function(t){return{entries:t.entries.map(function(n){if(t.capitalizationOptions.some(function(e){return e.id===n.id&&e.checked})){var i=Object.assign({},n);return"initialCase"===e?(i.capitalization=i.initialCapitalization,i.TITLE=i.correctionInitialCase):"titleCase"===e?(i.capitalization="titleCase",i.TITLE=i.correctionTitleCase):"sentenceCase"===e&&(i.capitalization="sentenceCase",i.TITLE=i.correctionSentenceCase),i}return Object.assign({},n)})}},function(){S({entries:n.state.entries})}),n.changeAllOptions(!1)},n.changeAllOptions=function(e){return n.setState(function(t){return{capitalizationOptions:t.capitalizationOptions.map(function(t){return t.checked=e,t})}})},n.changeAllAuthorNameOptions=function(e){return n.setState(function(t){return{authorNameOptions:t.authorNameOptions.map(function(t){return t.checked=e,t})}})},n.changeAuthorNameOption=function(e){n.setState(function(t){return{authorNameOptions:t.authorNameOptions.map(function(t){if(t.author===e.author&&t.entryId===e.entryId){var n=Object.assign({},t);return n.checked=!t.checked,n}return t})}})},n.changeOptionsCheckboxes=function(e){return n.setState(function(t){return{capitalizationOptions:t.capitalizationOptions.filter(function(t){return t.id!==e.id}).concat([e])}})},n.changeMissingFieldsOption=function(e){n.setState(function(t){return{missingFieldsOptions:t.missingFieldsOptions.map(function(t){if(t.entryId===e.entryId&&t.field===e.field){var n=Object.assign({},e);return n.checked=!n.checked,n}return t})}})},n.loadDataFromServer=function(e){return n.setState({entries:e.entries,capitalizationOptions:e.entries.map(function(e){return{id:e.id,checked:!1}}),authorNameOptions:n.setInitialAuthorNameOptions(e.entries),missingFieldsOptions:n.setInitialMissingFieldsOptions(e.entries)})},n.onSetBibtexText=function(e){C({bibtexText:e}).then(function(){return v().then(function(e){return n.loadDataFromServer(e)})})},n.changeAuthorName=function(){n.setState(function(e){return{entries:e.entries.map(function(e){if(null!=e.AUTHOR&&n.state.authorNameOptions.some(function(t){return t.entryId===e.id&&t.checked})){var t=Object.assign({},e),i=t.AUTHOR.map(function(t){if(null!=n.state.authorNameOptions.find(function(n){return n.author===t.name&&n.checked&&n.entryId===e.id})&&null!=t.suggestion&&t.suggestion.length>0&&(t.abbreviated||t.misspelling)){var i=Object.assign({},t);return i.name=i.suggestion[0],t.abbreviated&&(i.abbreviated=!1,i.changedAbbreviation=!0),t.misspelling&&(i.misspelling=!1,i.changedMisspelling=!0),i}return t});return t.AUTHOR=i,t}return e})}},function(){n.setState(function(e){return{authorNameOptions:n.setInitialAuthorNameOptions(e.entries)}},function(){S({entries:n.state.entries})})})},n.changeAuthorSuggestion=function(e){e.forEach(function(e){n.searchAuthorSuggestion(e.title,e.author).then(function(t){console.log(t),null!=t&&n.setState(function(n){return{entries:n.entries.map(function(n){if(n.id===e.entryId){var i=n.AUTHOR.map(function(n){if(n.name===e.author){var i=Object.assign({},n);return i.suggestion.unshift(t),console.log(i),i}return n});return n.AUTHOR=i,n}return n})}},function(){S({entries:n.state.entries})})})}),n.setState(function(e){return{authorNameOptions:n.setInitialAuthorNameOptions(e.entries)}})},n.searchAuthorSuggestion=function(e,t){return y(e.replace(/[\s]+/g,"+"),t.replace(/[\s]+/g,"+")).then(function(e){if(null!=e&&null!=e.message&&e.message.items.length>0&&null!=e.message.items[0].author){var n=e.message.items[0].author.find(function(e){return t.startsWith(e.family)});return null!=n?"".concat(n.family,", ").concat(n.given):null}return null})},n.changeFieldSuggestion=function(){n.state.entries.filter(function(e){return n.state.missingFieldsOptions.some(function(t){return t.entryId===e.id&&t.checked})}).forEach(function(e){return n.searchFieldSuggestion(e.TITLE).then(function(t){t.title.length>0&&t.title[0].toLowerCase().startsWith(e.TITLE.toLowerCase())?(console.log("title is the same"),n.state.missingFieldsOptions.filter(function(t){return t.entryId===e.id&&t.checked&&0===t.suggestion.length}).forEach(function(i){if(("booktitle"===i.field||"journal"===i.field)&&null!=t["container-title"]&&t["container-title"].length>0&&n.addSuggestion(e.id,i.field,[t["container-title"][0]]),"year"===i.field&&null!=t.created&&n.addSuggestion(e.id,"year",[t.created["date-parts"][0][0]]),"author"===i.field&&null!=t.author&&t.author.length>0){var a=t.author.map(function(e){return"".concat(e.family,", ").concat(e.given)});n.addSuggestion(e.id,"author",a)}})):console.log("title is not the same")})})},n.addSuggestion=function(e,t,i){i.forEach(function(i){n.setState(function(n){return{missingFieldsOptions:n.missingFieldsOptions.map(function(n){if(n.entryId===e&&n.field===t){var a=Object.assign({},n);return a.suggestion.push(i),a}return n})}})})},n.addMissingField=function(){n.state.missingFieldsOptions.filter(function(e){return e.checked&&e.suggestion.length>0}).forEach(function(e){n.setState(function(t){return{entries:t.entries.map(function(t){if(t.id===e.entryId&&null==t[e.field.toUpperCase()]){var n=e.field.toUpperCase();if("author"===e.field){var i={AUTHOR:e.suggestion,abbreviated:!1,changedAbbreviation:!1,misspelling:!1,changedMisspelling:!1},a=Object.assign(t,i);return a.missingRequiredFields=a.missingRequiredFields.filter(function(e){return"author"!==e}),a.correctedRequiredFields.push("author"),a}var r=Object.assign(t,Object(c.a)({},n,e.suggestion[0]));return r.missingRequiredFields=r.missingRequiredFields.filter(function(t){return t!==e.field}),r.correctedRequiredFields.push(e.field),r}return t})}},function(){S({entries:n.state.entries})})}),n.removCheckOptions()},n.removCheckOptions=function(){n.setState(function(e){return{missingFieldsOptions:e.missingFieldsOptions.map(function(e){if(e.checked){var t=Object.assign({},e);return t.checked=!1,t}return e})}})},n.selectAllMissingFieldsOptions=function(e){n.setState(function(t){return{missingFieldsOptions:t.missingFieldsOptions.map(function(t){var n=Object.assign({},t);return n.checked=e,n})}})},n.searchFieldSuggestion=function(e){return A(e.replace(/[\s]+/g,"+")).then(function(e){return null!=e&&null!=e.message&&e.message.items.length>0&&null!=e.message.items[0]?e.message.items[0]:null})},n}return Object(d.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.setState(function(t){return{capitalizationOptions:t.entries.map(function(e){return{id:e.id,checked:!1}}),authorNameOptions:e.setInitialAuthorNameOptions(t.entries),missingFieldsOptions:e.setInitialMissingFieldsOptions(t.entries)}},this.getEntriesFromServer())}},{key:"render",value:function(){return a.a.createElement("div",{className:"App"},a.a.createElement("header",{className:"App-header"},a.a.createElement("a",{className:"App-link",href:"app"},"cleanBibteX")),a.a.createElement(m,{setBibtex:this.onSetBibtexText}),a.a.createElement(x,{entries:this.state.entries,capitalizationOptions:this.state.capitalizationOptions,changeOption:this.changeOptionsCheckboxes,changeAllOptions:this.changeAllOptions,changeSelectedCapitalization:this.changeSelectedCapitalization,getEntriesFromServer:this.getEntriesFromServer,changeAuthorName:this.changeAuthorName,changeAuthorSuggestion:this.changeAuthorSuggestion,authorNameOptions:this.state.authorNameOptions,changeAuthorNameOption:this.changeAuthorNameOption,changeAllAuthorNameOptions:this.changeAllAuthorNameOptions,missingFieldsOptions:this.state.missingFieldsOptions,changeMissingFieldsOption:this.changeMissingFieldsOption,changeFieldSuggestion:this.changeFieldSuggestion,addMissingField:this.addMissingField,selectAllMissingFieldsOptions:this.selectAllMissingFieldsOptions}))}}]),t}(i.Component);s.a.render(a.a.createElement(I,null),document.getElementById("root"))},9:function(e,t,n){e.exports=n(16)}},[[9,1,2]]]);
//# sourceMappingURL=main.9ae2d823.chunk.js.map